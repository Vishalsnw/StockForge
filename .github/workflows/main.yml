name: Move src folder to frontend

on:
  workflow_dispatch:

jobs:
  move-src-folder:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Remove existing frontend/src (if any)
        run: |
          if [ -d "frontend/src" ]; then
            rm -rf frontend/src
            echo "Removed existing frontend/src"
          fi

      - name: Ensure frontend folder exists
        run: mkdir -p frontend

      - name: Move src folder into frontend
        run: |
          if [ -d "src" ]; then
            mv src frontend/
            echo "src folder moved to frontend/"
          else
            echo "No src folder found in root!"
            exit 1
          fi

      - name: Show new structure
        run: tree -L 2

      - name: Commit and push changes
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add frontend/src
          git rm -r --cached src || true
          git commit -m "Move src folder to frontend (overwrite old src)"
          git push
