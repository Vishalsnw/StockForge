name: ğŸ¦ StockForge Auto-Fix Duplicates

on:
  workflow_dispatch:
    inputs:
      fix_type:
        description: 'Type of fix to apply'
        required: true
        default: 'remove_duplicates'
        type: choice
        options:
          - remove_duplicates
          - update_timestamps
          - full_cleanup
      user_name:
        description: 'Target User (default: Vishalsnw)'
        required: false
        default: 'Vishalsnw'
        type: string

  push:
    branches: [main]
    paths:
      - 'frontend/src/hooks/useBotMarket.js'
      - 'src/hooks/useBotMarket.js'

  workflow_run:
    workflows: ["Vercel Production Deployment"]
    types: [completed]

jobs:
  auto-fix-duplicates:
    name: ğŸ”§ Fix Duplicate Declarations
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“… Display Current Info
        run: |
          echo "ğŸ¦ STOCKFORGE AUTO-FIX WORKFLOW"
          echo "ğŸ‘¤ User: ${{ github.event.inputs.user_name != '' && github.event.inputs.user_name || 'Vishalsnw' }}"
          echo "ğŸ“… UTC Time: 2025-06-12 13:33:30"
          echo "ğŸ¯ Fix Type: ${{ github.event.inputs.fix_type != '' && github.event.inputs.fix_type || 'remove_duplicates' }}"
          echo "ğŸš€ Workflow: auto-fix-duplicates"
          echo "=================================================="

      - name: ğŸ”„ Checkout Repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: ğŸ” Detect Package Structure
        id: detect-structure
        run: |
          echo "ğŸ” Analyzing project structure..."
          if [ -f "frontend/package.json" ]; then
            echo "ğŸ“¦ Found: frontend/package.json"
            echo "project_type=frontend" >> $GITHUB_OUTPUT
            echo "package_path=frontend" >> $GITHUB_OUTPUT
            echo "has_package_json=true" >> $GITHUB_OUTPUT
            if [ -f "frontend/package-lock.json" ]; then
              echo "ğŸ”’ Found: frontend/package-lock.json"
              echo "has_lockfile=true" >> $GITHUB_OUTPUT
              echo "lockfile_path=frontend/package-lock.json" >> $GITHUB_OUTPUT
            else
              echo "âš ï¸ Missing: frontend/package-lock.json"
              echo "has_lockfile=false" >> $GITHUB_OUTPUT
            fi
          elif [ -f "package.json" ]; then
            echo "ğŸ“¦ Found: package.json (root)"
            echo "project_type=root" >> $GITHUB_OUTPUT
            echo "package_path=." >> $GITHUB_OUTPUT
            echo "has_package_json=true" >> $GITHUB_OUTPUT
            if [ -f "package-lock.json" ]; then
              echo "ğŸ”’ Found: package-lock.json (root)"
              echo "has_lockfile=true" >> $GITHUB_OUTPUT
              echo "lockfile_path=package-lock.json" >> $GITHUB_OUTPUT
            else
              echo "âš ï¸ Missing: package-lock.json (root)"
              echo "has_lockfile=false" >> $GITHUB_OUTPUT
            fi
          else
            echo "âŒ No package.json found!"
            echo "project_type=none" >> $GITHUB_OUTPUT
            echo "has_package_json=false" >> $GITHUB_OUTPUT
            echo "has_lockfile=false" >> $GITHUB_OUTPUT
          fi

      - name: ğŸ› ï¸ Setup Node.js (With Cache)
       
