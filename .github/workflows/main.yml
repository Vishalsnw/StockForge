name: Analyze and Describe StockForge Repository

on:
  workflow_dispatch:

jobs:
  analyze-repo:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install dependencies
        run: |
          if [ -f "package.json" ]; then
            npm install || true
          fi
          if [ -f "backend/package.json" ]; then
            cd backend && npm install || true && cd ..
          fi
          if [ -f "frontend/package.json" ]; then
            cd frontend && npm install || true && cd ..
          fi

      - name: List main project files and folders
        run: |
          echo "Repository structure:"
          tree -L 3 || ls -R | head -50

      - name: Search for main technologies and frameworks
        run: |
          echo "Detected technologies:"
          grep -iE 'express|mongoose|react|redux|mysql|sequelize|socket|mongodb' \
            backend/package.json frontend/package.json package.json || true

      - name: Summarize backend endpoints
        run: |
          echo "Backend API Endpoints (express style):"
          grep -r 'app\.use\|app\.get\|app\.post\|app\.put\|app\.delete' backend/ || true

      - name: Summarize frontend routes
        run: |
          echo "Frontend Routes (react-router style):"
          grep -r '<Route' frontend/src/ || true

      - name: Output README if exists
        run: |
          if [ -f README.md ]; then
            echo "README content:"
            cat README.md
          else
            echo "No README found."
          fi

      - name: Final auto-analysis summary
        run: |
          echo "This repository appears to be a stock market simulation game with a React frontend and Node.js/Express backend. It includes trading features, bot simulation, and a professional UI. For more, see the README above or explore the source code files."
